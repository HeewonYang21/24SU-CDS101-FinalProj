---
output:
  html_document: default
  pdf_document: default
---
#Set up
```{r setup, include = FALSE}

# Load required packages
library(dplyr)

suppressPackageStartupMessages(library(tidyverse))
suppressPackageStartupMessages(library(infer))
```

#[Intro & DataSet]

```{r}
emissions <- read.csv("emissions.csv")
save_the_bees <- read.csv("save_the_bees.csv")
us_tornado_1950_2021 <-
  read.csv("us_tornado_dataset_1950_2021.csv")
```

### filter 2015-2021
```{r}
emission_21 <-filter(emissions, year >= 2015 & year <= 2021)
bee_21 <- filter(save_the_bees, year >= 2015 & year <= 2021)
tornado_21 <- filter(us_tornado_1950_2021, yr >= 2015 & yr <= 2021)

```

## Honey Bee
### select useful data
```{r}
bee_21 <- bee_21 %>%
  select( state, state_code, quarter, year, max_colonies
  )
```

### pivot wider into q1~q4
```{r}
bee_21 <- bee_21 %>%
  pivot_wider(
    names_from = quarter,
    values_from = max_colonies
  )
```

```{r}
bee_21 <- bee_21 %>%
  rename(q1 = '1', q2 = '2', q3 = '3', q4 = '4')
```

### mutate average max colonies
```{r}
bee_21 <- bee_21 %>%
  mutate(
    avg_max_col = if_else(
      year != "2019",
      (q1 + q2 + q3 + q4) / 4, (q1 + q3 + q4) / 3) )
```

### select state
https://www.statista.com/statistics/191996/top-10-honey-producing-us-states/

Top 10 honey producing U.S. states in 2022
: North Dakota, California, Texas, Montana, Florida, South Dakota, Minnesota, Oregon, Michigan, Georgia

```{r}
bee_top_10 <- bee_21 %>%
  filter(state %in% c("North Dakota", "California", "Texas","Montana", "Florida", 
                      "South Dakota", "Minnesota", "Oregon", "Michigan", "Georgia" ))
```

```{r}
bee_top_10 <- bee_top_10 %>%
  select(year, state, avg_max_col)
```


## CO2 emission
### sum of each fuel.name value
```{r}
emission_21 <- emission_21 %>%
  group_by(year,state.name, fuel.name) %>%
  summarise(sum_value = sum(value, na.rm = TRUE),.groups = 'drop')

emission_21 <- emission_21 %>%
  rename(state = state.name)
```
### pivot wide each fuel name
```{r}
emission_21 <- emission_21 %>%
  pivot_wider(
    names_from = fuel.name,
    values_from = sum_value
  )
```

### filter Top 10 honey producers
```{r}
emission_10 <- emission_21 %>%
  filter(state %in% c("North Dakota", "California", "Texas","Montana", "Florida",
                           "South Dakota", "Minnesota", "Oregon", "Michigan", "Georgia" ))
```

```{r}
emission_10 <- emission_10 %>%
  rename(all_fules = `All Fuels`) %>%
  select(year, state, all_fules)
```

## Tornado
### Frequency
```{r}
tornado_21 <- tornado_21 %>%
  group_by(yr, st) %>%
  summarise(
    count= n(), .groups = 'drop'
  ) %>%
  rename(year = yr, state = st)
```

```{r}
tornado_10 <- tornado_21 %>%
  filter(state %in% c("ND", "CA", "TX", "MT", "FL", "SD", "MN", "OR", "MI", "GA")) %>%
  mutate(state = recode(state, 
                     "ND" = "North Dakota", "CA" = "California",
                     "TX" = "Texas", "MT" = "Montana",
                     "FL" = "Florida","SD" = "South Dakota",
                     "MN" = "Minnesota","OR" = "Oregon",
                     "MI" = "Michigan","GA" = "Georgia"))
```

## merge
```{r}
bee_df <- merge(bee_top_10, emission_10, c("year", "state"))
bee_df <- merge(bee_df, tornado_10, c("year", "state"))  
```

## EDA / Visualization

```{r}
#Dividing avg_max_col by 1000
bee_df <- bee_df %>%
  mutate(avg_max_col_1000 = avg_max_col/1000)
```

```{r}
#Histogram of average bees
bee_df %>%
  ggplot() +
  geom_histogram(mapping = aes(x = avg_max_col_1000,fill = state), bins = 20) +
  facet_wrap(~year) +
  labs(title = "Distribution of Average Maximum Colonies",
       x = "Average Maximum Colonies (1 = 1000)",
       y = "Frequency")
```

```{r}
#Histogram of Carbon Emission
bee_df %>%
  ggplot() +
  geom_histogram(mapping = aes(x = all_fules,fill = state), bins = 20) +
  facet_wrap(~year) +
  labs(title = "Distribution of Carbon Emissions",
       x = "Carbon Emission",
       y = "Frequency")
```

```{r}
#Histogram of Tornado
bee_df %>%
  ggplot() +
  geom_histogram(mapping = aes(x = count, fill = state), bins = 20) +
  facet_wrap(~year) +
  labs(title = "Distribution of Tornado",
       x = "Carbon Emission",
       y = "Frequency")
```
```{r,}
#Boxplot of average colonies
bee_df %>%
  ggplot() +
  geom_boxplot(mapping = aes(x = avg_max_col_1000), bins = 20) +
  facet_wrap(~year) +
  labs(title = "Distribution of Average Maximum Colonies",
       x = "Average Maximum Colonies (1 = 1000)",
       y = "Frequency")
```

```{r,}
#Boxplot of Emission
bee_df %>%
  ggplot() +
  geom_boxplot(mapping = aes(x = all_fules), bins = 20) +
  facet_wrap(~year) +
  labs(title = "Distribution of Tornado",
       x = "Carbon Emission",
       y = "Frequency")
```


```{r,}
#Boxplot of Tornado
bee_df %>%
  ggplot() +
  geom_boxplot(mapping = aes(x = count), bins = 20) +
  facet_wrap(~year) +
  labs(title = "Distribution of Tornado",
       x = "Count of tornado",
       y = "Frequency")
```

##Hypothesis testing Idea


##Modeling (lm)




bees using data max number.
single interaction multiple lm(y ~ x1 + x2 + x1*x2)

  

